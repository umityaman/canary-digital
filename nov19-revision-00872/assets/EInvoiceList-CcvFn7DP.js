import{r as f,t as c,j as e}from"./react-vendor-DBHNAGPW.js";import{am as Ee,a6 as Ae,an as Q,U as De,F as ae,ac as Se,ap as $e,R as ne,aY as se,a0 as ze,X as ie,C as J,bn as ce,f as oe,D as Ce,Z as Te,aC as ke,u as re,o as Re,a_ as Ie,ag as Pe,A as le}from"./ui-vendor-Vc_pfhQB.js";import{D as M,c as H,a as O,i as Fe}from"./index-C5wiI25D.js";import"./chart-vendor-R5Y1AjBI.js";function Le({onClose:a,onSuccess:U,editInvoice:o}){var k,X;const[z,w]=f.useState([]),[C,g]=f.useState(!1),[b,F]=f.useState({customerId:(o==null?void 0:o.customerId)||"",issueDate:((k=o==null?void 0:o.issueDate)==null?void 0:k.split("T")[0])||new Date().toISOString().split("T")[0],dueDate:((X=o==null?void 0:o.dueDate)==null?void 0:X.split("T")[0])||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],description:(o==null?void 0:o.description)||"",notes:(o==null?void 0:o.notes)||""}),[v,E]=f.useState((o==null?void 0:o.items)||[{id:"1",description:"",quantity:1,unitPrice:0,discountPercentage:0,taxRate:20,total:0}]);f.useEffect(()=>{W()},[]),f.useEffect(()=>{ee()},[v]);const W=async()=>{try{const s=await fetch("/api/customers",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!s.ok)throw new Error("Failed to load customers");const l=await s.json();w(l.data||[])}catch(s){console.error("Failed to load customers:",s),c.error("Müşteriler yüklenemedi")}},ee=()=>{E(s=>s.map(l=>{const r=l.quantity*l.unitPrice,x=r*(l.discountPercentage/100),m=r-x,d=m*(l.taxRate/100),N=m+d;return{...l,total:N}}))},G=()=>{const s={id:Date.now().toString(),description:"",quantity:1,unitPrice:0,discountPercentage:0,taxRate:20,total:0};E([...v,s])},P=s=>{if(v.length===1){c.error("En az bir kalem olmalı");return}E(v.filter(l=>l.id!==s))},D=(s,l,r)=>{E(x=>x.map(m=>m.id===s?{...m,[l]:r}:m))},q=()=>{const s=v.reduce((m,d)=>{const N=d.quantity*d.unitPrice;return m+N},0),l=v.reduce((m,d)=>{const B=d.quantity*d.unitPrice*(d.discountPercentage/100);return m+B},0),r=v.reduce((m,d)=>{const N=d.quantity*d.unitPrice,B=N*(d.discountPercentage/100),y=(N-B)*(d.taxRate/100);return m+y},0),x=s-l+r;return{subtotal:s,discountTotal:l,taxTotal:r,grandTotal:x}},L=async(s=!1)=>{var l;if(!b.customerId){c.error("Lütfen müşteri seçin");return}if(v.some(r=>!r.description||r.quantity<=0||r.unitPrice<=0)){c.error("Lütfen tüm kalem bilgilerini doldurun");return}g(!0);try{const r=q(),x=z.find(y=>y.id===Number(b.customerId)),m={customerId:Number(b.customerId),issueDate:b.issueDate,dueDate:b.dueDate,description:b.description,notes:b.notes,items:v.map(y=>({description:y.description,quantity:y.quantity,unitPrice:y.unitPrice,discountPercentage:y.discountPercentage,taxRate:y.taxRate})),subtotal:r.subtotal,discountAmount:r.discountTotal,taxAmount:r.taxTotal,grandTotal:r.grandTotal,status:s?"sent":"draft",invoiceType:x!=null&&x.taxNumber?"e-fatura":"e-arsiv"},d=o?`/api/invoices/${o.id}`:"/api/invoices",B=await fetch(d,{method:o?"PUT":"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(m)});if(!B.ok)throw new Error("Failed to save invoice");const V=await B.json();if(s&&((l=V.data)!=null&&l.id))try{const y=localStorage.getItem("token");if(!y)throw new Error("Oturum bilgisi bulunamadı");const $={Authorization:`Bearer ${y}`};if(m.invoiceType==="e-fatura"){const K=await fetch(`/api/einvoice/generate/${V.data.id}`,{method:"POST",headers:$}),R=await K.json().catch(()=>({}));if(!K.ok)throw new Error((R==null?void 0:R.message)||"E-Fatura XML oluşturulamadı");const I=await fetch(`/api/einvoice/send/${V.data.id}`,{method:"POST",headers:$}),Z=await I.json().catch(()=>({}));if(!I.ok)throw new Error((Z==null?void 0:Z.message)||"E-Fatura gönderilemedi")}else{const K={...$,"Content-Type":"application/json"},R=await fetch(`/api/invoices/${V.data.id}/send-edocument`,{method:"POST",headers:K});if(!R.ok){const I=await R.json().catch(()=>({}));throw new Error((I==null?void 0:I.message)||"E-Arşiv gönderilemedi")}}c.success("Fatura oluşturuldu ve e-belge gönderildi")}catch(y){console.error("Failed to auto-send invoice:",y),c.warning(y.message||"Fatura oluşturuldu ancak e-belge gönderilemedi")}else c.success(o?"Fatura güncellendi":"Fatura oluşturuldu");U()}catch(r){console.error("Failed to save invoice:",r),c.error("Fatura kaydedilemedi")}finally{g(!1)}},T=q(),p=z.find(s=>s.id===Number(b.customerId)),A=p!=null&&p.taxNumber?"E-Fatura":"E-Arşiv";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:a,className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors",children:e.jsx(Ee,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:o?"Fatura Düzenle":"Yeni Fatura Oluştur"}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:p&&e.jsx("span",{className:`font-medium ${p.taxNumber,"text-neutral-900"}`,children:A})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>L(!1),disabled:C,className:"flex items-center gap-2 px-4 py-2 bg-white border border-neutral-300 text-neutral-700 rounded-xl hover:bg-neutral-50 transition-colors disabled:opacity-50",children:[e.jsx(Ae,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Taslak Kaydet"})]}),e.jsxs("button",{onClick:()=>L(!0),disabled:C,className:"flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-xl hover:bg-neutral-800 transition-colors disabled:opacity-50",children:[e.jsx(Q,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Kaydet & Gönder"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(De,{size:20}),"Müşteri Bilgileri"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Müşteri *"}),e.jsxs("select",{value:b.customerId,onChange:s=>F({...b,customerId:s.target.value}),className:"w-full px-4 py-2.5 bg-neutral-50 border border-neutral-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-neutral-900",required:!0,children:[e.jsx("option",{value:"",children:"Müşteri seçin"}),z.map(s=>e.jsxs("option",{value:s.id,children:[s.fullName," ",s.taxNumber?`(VN: ${s.taxNumber})`:""]},s.id))]})]}),p&&e.jsxs("div",{className:"bg-neutral-50 rounded-xl p-4 space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Ad:"}),e.jsx("span",{className:"ml-2 font-medium text-neutral-900",children:p.fullName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"E-posta:"}),e.jsx("span",{className:"ml-2 font-medium text-neutral-900",children:p.email})]}),p.taxNumber&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Vergi No:"}),e.jsx("span",{className:"ml-2 font-medium text-neutral-900",children:p.taxNumber})]}),p.taxOffice&&e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Vergi Dairesi:"}),e.jsx("span",{className:"ml-2 font-medium text-neutral-900",children:p.taxOffice})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-neutral-200",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${p.taxNumber,"bg-neutral-100 text-neutral-800"}`,children:A})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Tarihler"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Fatura Tarihi *"}),e.jsx("input",{type:"date",value:b.issueDate,onChange:s=>F({...b,issueDate:s.target.value}),className:"w-full px-4 py-2.5 bg-neutral-50 border border-neutral-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-neutral-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Vade Tarihi *"}),e.jsx("input",{type:"date",value:b.dueDate,onChange:s=>F({...b,dueDate:s.target.value}),className:"w-full px-4 py-2.5 bg-neutral-50 border border-neutral-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-neutral-900",required:!0})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Notlar"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Açıklama"}),e.jsx("textarea",{value:b.description,onChange:s=>F({...b,description:s.target.value}),rows:3,className:"w-full px-4 py-2.5 bg-neutral-50 border border-neutral-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-neutral-900 resize-none",placeholder:"Fatura açıklaması..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Dahili Notlar"}),e.jsx("textarea",{value:b.notes,onChange:s=>F({...b,notes:s.target.value}),rows:3,className:"w-full px-4 py-2.5 bg-neutral-50 border border-neutral-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-neutral-900 resize-none",placeholder:"Dahili notlar (faturada görünmez)..."})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 flex items-center gap-2",children:[e.jsx(ae,{size:20}),"Fatura Kalemleri"]}),e.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-3 py-2 bg-neutral-900 text-white text-sm rounded-xl hover:bg-neutral-800 transition-colors",children:[e.jsx(Se,{size:16}),"Kalem Ekle"]})]}),e.jsx("div",{className:"space-y-4",children:v.map((s,l)=>e.jsxs("div",{className:"bg-neutral-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-neutral-700",children:["Kalem ",l+1]}),v.length>1&&e.jsx("button",{onClick:()=>P(s.id),className:"p-1 hover:bg-neutral-50 rounded-lg transition-colors",children:e.jsx($e,{size:16,className:"text-neutral-800"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("input",{type:"text",value:s.description,onChange:r=>D(s.id,"description",r.target.value),placeholder:"Ürün/Hizmet açıklaması *",className:"w-full px-3 py-2 bg-white border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 text-sm",required:!0})}),e.jsx("div",{children:e.jsx("input",{type:"number",value:s.quantity,onChange:r=>D(s.id,"quantity",Number(r.target.value)),placeholder:"Miktar",min:"0.01",step:"0.01",className:"w-full px-3 py-2 bg-white border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 text-sm",required:!0})}),e.jsx("div",{children:e.jsx("input",{type:"number",value:s.unitPrice,onChange:r=>D(s.id,"unitPrice",Number(r.target.value)),placeholder:"Birim Fiyat (₺)",min:"0",step:"0.01",className:"w-full px-3 py-2 bg-white border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 text-sm",required:!0})}),e.jsx("div",{children:e.jsx("input",{type:"number",value:s.discountPercentage,onChange:r=>D(s.id,"discountPercentage",Number(r.target.value)),placeholder:"İskonto (%)",min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 bg-white border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 text-sm"})}),e.jsx("div",{children:e.jsxs("select",{value:s.taxRate,onChange:r=>D(s.id,"taxRate",Number(r.target.value)),className:"w-full px-3 py-2 bg-white border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 text-sm",children:[e.jsx("option",{value:"0",children:"KDV %0"}),e.jsx("option",{value:"1",children:"KDV %1"}),e.jsx("option",{value:"10",children:"KDV %10"}),e.jsx("option",{value:"20",children:"KDV %20"})]})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-neutral-200",children:[e.jsx("span",{className:"text-sm text-neutral-600",children:"Toplam:"}),e.jsx("span",{className:"text-lg font-bold text-neutral-900",children:new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(s.total)})]})]},s.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Fatura Özeti"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-neutral-700",children:[e.jsx("span",{children:"Ara Toplam:"}),e.jsx("span",{className:"font-semibold",children:new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(T.subtotal)})]}),T.discountTotal>0&&e.jsxs("div",{className:"flex items-center justify-between text-neutral-700",children:[e.jsx("span",{children:"İskonto:"}),e.jsxs("span",{className:"font-semibold text-neutral-800",children:["-",new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(T.discountTotal)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-neutral-700",children:[e.jsx("span",{children:"KDV:"}),e.jsx("span",{className:"font-semibold",children:new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(T.taxTotal)})]}),e.jsx("div",{className:"pt-3 border-t-2 border-neutral-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-bold text-neutral-900",children:"Genel Toplam:"}),e.jsx("span",{className:"text-2xl font-bold text-neutral-900",children:new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(T.grandTotal)})]})})]})]})]})]})]})}function Be({invoice:a,onBack:U,onUpdate:o}){var D,q,L,T,p,A,k,X;const[z,w]=f.useState(!1),C=(s=!1)=>{const l=localStorage.getItem("token");if(!l)return c.error("Oturum bilgisi bulunamadı"),null;const r={Authorization:`Bearer ${l}`};return s&&(r["Content-Type"]="application/json"),r},g=s=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2,maximumFractionDigits:2}).format(s),b=s=>new Date(s).toLocaleDateString("tr-TR",{day:"2-digit",month:"long",year:"numeric"}),F=async()=>{if(a.invoiceType==="e-fatura"){const l=C();if(!l)return;w(!0);try{const r=await fetch(`/api/einvoice/generate/${a.id}`,{method:"POST",headers:l}),x=await r.json().catch(()=>({}));if(!r.ok)throw new Error((x==null?void 0:x.message)||"E-Fatura XML oluşturulamadı");const m=await fetch(`/api/einvoice/send/${a.id}`,{method:"POST",headers:l}),d=await m.json().catch(()=>({}));if(!m.ok)throw new Error((d==null?void 0:d.message)||"E-Fatura gönderilemedi");c.success("E-Fatura GİB'e gönderildi"),o()}catch(r){console.error("Failed to send e-invoice:",r),c.error(r.message||"E-Fatura gönderilemedi")}finally{w(!1)}return}if(!a.parasutId){c.error("Paraşüt fatura ID bulunamadı");return}const s=C(!0);if(s){w(!0);try{const l=await fetch(`/api/invoices/${a.id}/send-edocument`,{method:"POST",headers:s});if(!l.ok){const r=await l.json().catch(()=>({}));throw new Error((r==null?void 0:r.message)||"E-Arşiv gönderilemedi")}c.success("E-Arşiv başarıyla oluşturuldu"),o()}catch(l){console.error("Failed to send e-document:",l),c.error(l.message||"E-Belge gönderilemedi")}finally{w(!1)}}},v=async()=>{var l;if(a.invoiceType!=="e-fatura")return;const s=C();if(s){w(!0);try{const r=await fetch(`/api/einvoice/status/${a.id}`,{method:"GET",headers:s}),x=await r.json().catch(()=>({}));if(!r.ok)throw new Error((x==null?void 0:x.message)||"Durum sorgulanamadı");c.success(`GİB durumu: ${((l=x==null?void 0:x.data)==null?void 0:l.status)||"bilinmiyor"}`),o()}catch(r){console.error("Failed to check e-invoice status:",r),c.error(r.message||"Durum sorgulanamadı")}finally{w(!1)}}},E=async()=>{if(a.invoiceType!=="e-fatura")return;const s=C();if(s){w(!0);try{const l=await fetch(`/api/einvoice/xml/${a.id}`,{method:"GET",headers:s});if(!l.ok){const N=await l.json().catch(()=>({}));throw new Error((N==null?void 0:N.message)||"XML indirilemedi")}const r=await l.text(),x=new Blob([r],{type:"application/xml"}),m=window.URL.createObjectURL(x),d=document.createElement("a");d.href=m,d.download=`${a.invoiceNumber||a.id}-efatura.xml`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(m),c.success("E-Fatura XML indirildi")}catch(l){console.error("Failed to download e-invoice XML:",l),c.error(l.message||"XML indirilemedi")}finally{w(!1)}}},W=async()=>{if(confirm("Bu faturayı iptal etmek istediğinize emin misiniz?")){w(!0);try{if(!(await fetch(`/api/invoices/${a.id}/cancel`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error("Failed to cancel invoice");c.success("Fatura iptal edildi"),o(),U()}catch(s){console.error("Failed to cancel invoice:",s),c.error("Fatura iptal edilemedi")}finally{w(!1)}}},ee=()=>{c.info("PDF indirme özelliği yakında eklenecek")},P=(s=>{const l={draft:{label:"Taslak",color:"text-neutral-700",bgColor:"bg-neutral-100"},sent:{label:"Gönderildi",color:"text-neutral-800",bgColor:"bg-neutral-100"},approved:{label:"Onaylandı",color:"text-neutral-800",bgColor:"bg-neutral-100"},rejected:{label:"Reddedildi",color:"text-neutral-800",bgColor:"bg-neutral-100"},cancelled:{label:"İptal",color:"text-neutral-800",bgColor:"bg-neutral-100"},paid:{label:"Ödendi",color:"text-neutral-800",bgColor:"bg-neutral-100"}};return l[s]||l.draft})(a.status);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:U,className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors",children:e.jsx(Ee,{size:24})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-neutral-900",children:["Fatura #",a.invoiceNumber]}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:e.jsx("span",{className:`font-medium ${a.invoiceType==="e-fatura","text-neutral-900"}`,children:a.invoiceType==="e-fatura"?"E-Fatura":"E-Arşiv"})})]})]}),e.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[a.status==="draft"&&e.jsxs("button",{onClick:F,disabled:z,className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-white rounded-xl hover:bg-neutral-50 transition-colors disabled:opacity-50",children:[e.jsx(Q,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"E-Belge Gönder"})]}),a.invoiceType==="e-fatura"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:v,disabled:z,className:"flex items-center gap-2 px-4 py-2 bg-neutral-200 text-neutral-800 rounded-xl hover:bg-neutral-300 transition-colors disabled:opacity-50",children:[e.jsx(ne,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Durum Sorgula"})]}),e.jsxs("button",{onClick:E,disabled:z,className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-white rounded-xl hover:bg-neutral-50 transition-colors disabled:opacity-50",children:[e.jsx(se,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"XML İndir"})]})]}),a.parasutId&&e.jsxs("button",{onClick:ee,className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-white rounded-xl hover:bg-neutral-50 transition-colors",children:[e.jsx(ze,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"PDF İndir"})]}),a.status!=="cancelled"&&a.status!=="paid"&&e.jsxs("button",{onClick:W,disabled:z,className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-white rounded-xl hover:bg-neutral-50 transition-colors disabled:opacity-50",children:[e.jsx(ie,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"İptal Et"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-semibold ${P.bgColor} ${P.color}`,children:[e.jsx(J,{size:16}),P.label]}),a.invoiceType==="e-fatura"?e.jsxs("span",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-semibold ${((D=a.eInvoiceMeta)==null?void 0:D.gibStatus)==="sent"||((q=a.eInvoiceMeta)==null?void 0:q.gibStatus)==="delivered"?"bg-neutral-100 text-neutral-800":"bg-neutral-100 text-neutral-700"}`,children:[e.jsx(ce,{size:16}),((L=a.eInvoiceMeta)==null?void 0:L.gibStatus)==="sent"?"GİB Gönderildi":((T=a.eInvoiceMeta)==null?void 0:T.gibStatus)==="delivered"?"GİB Yanıtı Alındı":"XML Taslak"]}):a.eDocumentStatus&&e.jsx("span",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-semibold ${a.eDocumentStatus==="delivered","bg-neutral-100 text-neutral-800"}`,children:a.eDocumentStatus==="delivered"?"E-Belge Teslim Edildi":"E-Belge İşleniyor"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(De,{size:20}),"Müşteri Bilgileri"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Müşteri:"}),e.jsx("div",{className:"font-semibold text-neutral-900 mt-1",children:a.customerName})]}),((p=a.customer)==null?void 0:p.email)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"E-posta:"}),e.jsx("div",{className:"font-medium text-neutral-900 mt-1",children:a.customer.email})]}),a.customerTaxNumber&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Vergi No:"}),e.jsx("div",{className:"font-medium text-neutral-900 mt-1",children:a.customerTaxNumber})]}),((A=a.customer)==null?void 0:A.taxOffice)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Vergi Dairesi:"}),e.jsx("div",{className:"font-medium text-neutral-900 mt-1",children:a.customer.taxOffice})]})]}),((k=a.customer)==null?void 0:k.address)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Adres:"}),e.jsx("div",{className:"font-medium text-neutral-900 mt-1",children:a.customer.address})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(ae,{size:20}),"Fatura Bilgileri"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Fatura No:"}),e.jsxs("div",{className:"font-semibold text-neutral-900 mt-1",children:["#",a.invoiceNumber]})]}),a.parasutInvoiceNo&&e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Paraşüt No:"}),e.jsx("div",{className:"font-medium text-neutral-900 mt-1",children:a.parasutInvoiceNo})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Fatura Tarihi:"}),e.jsxs("div",{className:"font-medium text-neutral-900 mt-1 flex items-center gap-2",children:[e.jsx(oe,{size:14}),b(a.issueDate)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Vade Tarihi:"}),e.jsxs("div",{className:"font-medium text-neutral-900 mt-1 flex items-center gap-2",children:[e.jsx(oe,{size:14}),b(a.dueDate)]})]}),a.description&&e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Açıklama:"}),e.jsx("div",{className:"font-medium text-neutral-900 mt-1",children:a.description})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(Ce,{size:20}),"Ödeme Bilgileri"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-neutral-800",children:"Toplam Tutar:"}),e.jsx("span",{className:"text-xl font-bold text-neutral-900",children:g(a.grandTotal)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-neutral-800",children:"Ödenen:"}),e.jsx("span",{className:"text-lg font-semibold text-neutral-800",children:g(a.paidAmount)})]}),e.jsx("div",{className:"pt-3 border-t border-neutral-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-800",children:"Kalan:"}),e.jsx("span",{className:"text-xl font-bold text-neutral-800",children:g(a.grandTotal-a.paidAmount)})]})})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Fatura Kalemleri"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[600px]",children:[e.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-700 uppercase",children:"Açıklama"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-neutral-700 uppercase",children:"Miktar"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"Birim Fiyat"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"İskonto"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"KDV"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"Toplam"})]})}),e.jsx("tbody",{className:"divide-y divide-neutral-200",children:(X=a.items)==null?void 0:X.map((s,l)=>{const r=s.quantity*s.unitPrice,x=r*(s.discountPercentage/100),m=r-x,d=m*(s.taxRate/100),N=m+d;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm text-neutral-900",children:s.description}),e.jsx("td",{className:"px-4 py-3 text-center text-sm text-neutral-700",children:s.quantity}),e.jsx("td",{className:"px-4 py-3 text-right text-sm text-neutral-700",children:g(s.unitPrice)}),e.jsx("td",{className:"px-4 py-3 text-right text-sm text-neutral-800",children:s.discountPercentage>0?`%${s.discountPercentage}`:"-"}),e.jsxs("td",{className:"px-4 py-3 text-right text-sm text-neutral-700",children:["%",s.taxRate]}),e.jsx("td",{className:"px-4 py-3 text-right text-sm font-semibold text-neutral-900",children:g(N)})]},l)})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Fatura Özeti"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-neutral-700",children:[e.jsx("span",{children:"Ara Toplam:"}),e.jsx("span",{className:"font-semibold",children:g(a.subtotal||0)})]}),a.discountAmount>0&&e.jsxs("div",{className:"flex items-center justify-between text-neutral-700",children:[e.jsx("span",{children:"İskonto:"}),e.jsxs("span",{className:"font-semibold text-neutral-800",children:["-",g(a.discountAmount)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-neutral-700",children:[e.jsx("span",{children:"KDV:"}),e.jsx("span",{className:"font-semibold",children:g(a.taxAmount||0)})]}),e.jsx("div",{className:"pt-3 border-t-2 border-neutral-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-bold text-neutral-900",children:"Genel Toplam:"}),e.jsx("span",{className:"text-2xl font-bold text-neutral-900",children:g(a.grandTotal)})]})})]})]}),(a.description||a.notes)&&e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-neutral-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Notlar"}),e.jsxs("div",{className:"space-y-3",children:[a.description&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Açıklama:"}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:a.description})]}),a.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Dahili Notlar:"}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:a.notes})]})]})]})]})]})]})}function Xe(){var K,R,I,Z,de,ue,xe,me,he,pe,be,ge,fe,je,Ne,ye;const[a,U]=f.useState([]),[o,z]=f.useState([]),[w,C]=f.useState(!0),[g,b]=f.useState(""),[F,v]=f.useState("all"),[E,W]=f.useState("all"),[ee,G]=f.useState(!1),[P,D]=f.useState(null),[q,L]=f.useState(!1),[T,p]=f.useState(null),A=(t=!1)=>{const n=localStorage.getItem("token");if(!n)return c.error("Oturum bilgisi bulunamad�"),null;const i={Authorization:`Bearer ${n}`};return t&&(i["Content-Type"]="application/json"),i};f.useEffect(()=>{k()},[]),f.useEffect(()=>{X()},[a,g,F,E]);const k=async()=>{C(!0);try{const t=await fetch("/api/invoices",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!t.ok)throw new Error("Failed to load invoices");const n=await t.json(),h=(n.data||n).map(u=>{var te,_,we,ve;const S=(te=u.customer)!=null&&te.taxNumber?"e-fatura":"e-arsiv",j=u.eInvoice?{uuid:u.eInvoice.uuid,gibStatus:u.eInvoice.gibStatus,ettn:u.eInvoice.ettn,sentDate:u.eInvoice.sentDate,responseDate:u.eInvoice.responseDate,xmlHash:u.eInvoice.xmlHash}:null,Y=S==="e-fatura"?(j==null?void 0:j.gibStatus)||"draft":u.parasutId?"delivered":null;return{...u,invoiceType:S,customerName:((_=u.customer)==null?void 0:_.fullName)||((we=u.customer)==null?void 0:we.name)||"Bilinmeyen",customerTaxNumber:((ve=u.customer)==null?void 0:ve.taxNumber)||null,eDocumentStatus:Y,eInvoiceMeta:j}});U(h)}catch(t){console.error("Failed to load invoices:",t),c.error("Faturalar y�klenemedi")}finally{C(!1)}},X=()=>{let t=[...a];g&&(t=t.filter(n=>{var i,h;return n.invoiceNumber.toLowerCase().includes(g.toLowerCase())||n.customerName.toLowerCase().includes(g.toLowerCase())||((i=n.customerTaxNumber)==null?void 0:i.includes(g))||((h=n.parasutInvoiceNo)==null?void 0:h.toLowerCase().includes(g.toLowerCase()))})),F!=="all"&&(t=t.filter(n=>n.invoiceType===F)),E!=="all"&&(t=t.filter(n=>n.status===E)),z(t)},s=t=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),l=t=>new Date(t).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"}),r=async t=>{if(t.invoiceType==="e-fatura"){const i=A();if(!i)return;try{p(t.id);const h=await fetch(`/api/einvoice/generate/${t.id}`,{method:"POST",headers:i}),u=await h.json().catch(()=>({}));if(!h.ok)throw new Error((u==null?void 0:u.message)||"E-Fatura XML olu�turulamad�");const S=await fetch(`/api/einvoice/send/${t.id}`,{method:"POST",headers:i}),j=await S.json().catch(()=>({}));if(!S.ok)throw new Error((j==null?void 0:j.message)||"E-Fatura g�nderilemedi");c.success("E-Fatura G�B'e g�nderildi"),k()}catch(h){console.error("Failed to send e-invoice:",h),c.error(h.message||"E-Fatura g�nderilemedi")}finally{p(null)}return}if(!t.parasutId){c.error("Para��t fatura ID bulunamad�");return}const n=A(!0);if(n)try{p(t.id);const i=await fetch(`/api/invoices/${t.id}/send-edocument`,{method:"POST",headers:n});if(!i.ok){const h=await i.json().catch(()=>({}));throw new Error((h==null?void 0:h.message)||"E-Ar�iv g�nderilemedi")}c.success("E-Ar�iv ba�ar�yla olu�turuldu"),k()}catch(i){console.error("Failed to send e-archive:",i),c.error(i.message||"E-Ar�iv g�nderilemedi")}finally{p(null)}},x=async t=>{var i;if(t.invoiceType!=="e-fatura")return;const n=A();if(n)try{p(t.id);const h=await fetch(`/api/einvoice/status/${t.id}`,{method:"GET",headers:n}),u=await h.json().catch(()=>({}));if(!h.ok)throw new Error((u==null?void 0:u.message)||"Durum sorgulanamad�");c.success(`G�B durumu: ${((i=u==null?void 0:u.data)==null?void 0:i.status)||"bilinmiyor"}`),k()}catch(h){console.error("Failed to check e-invoice status:",h),c.error(h.message||"Durum sorgulanamad�")}finally{p(null)}},m=async t=>{if(t.invoiceType!=="e-fatura")return;const n=A();if(n)try{p(t.id);const i=await fetch(`/api/einvoice/xml/${t.id}`,{method:"GET",headers:n});if(!i.ok){const Y=await i.json().catch(()=>({}));throw new Error((Y==null?void 0:Y.message)||"XML indirilemedi")}const h=await i.text(),u=new Blob([h],{type:"application/xml"}),S=window.URL.createObjectURL(u),j=document.createElement("a");j.href=S,j.download=`${t.invoiceNumber||t.id}-efatura.xml`,document.body.appendChild(j),j.click(),document.body.removeChild(j),window.URL.revokeObjectURL(S),c.success("E-Fatura XML indirildi")}catch(i){console.error("Failed to download e-invoice XML:",i),c.error(i.message||"XML indirilemedi")}finally{p(null)}},d=async t=>{if(confirm(`${t.invoiceNumber} numaral� faturay� iptal etmek istedi�inize emin misiniz?`))try{if(!(await fetch(`/api/invoices/${t.id}/cancel`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to cancel invoice");c.success("Fatura iptal edildi"),k()}catch(n){console.error("Failed to cancel invoice:",n),c.error("Fatura iptal edilemedi")}},N=async t=>{try{c.info("PDF indirme �zelli�i yak�nda eklenecek")}catch(n){console.error("Failed to download PDF:",n),c.error("PDF indirilemedi")}},B=t=>{const n={draft:{label:"Taslak",color:"bg-neutral-100 text-neutral-700",icon:e.jsx(se,{size:14})},sent:{label:"G�nderildi",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(Q,{size:14})},approved:{label:"Onayland�",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(J,{size:14})},rejected:{label:"Reddedildi",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(ie,{size:14})},cancelled:{label:"�ptal",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(le,{size:14})},paid:{label:"�dendi",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(J,{size:14})}},i=n[t]||n.draft;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium ${i.color}`,children:[i.icon,i.label]})},V=t=>{var u,S,j;if(t.invoiceType==="e-fatura"){const Y=((u=t.eInvoiceMeta)==null?void 0:u.gibStatus)||"draft",te={draft:{label:"XML Taslak",color:"bg-neutral-100 text-neutral-700",icon:e.jsx(se,{size:12})},sent:{label:"G�B G�nderildi",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(Q,{size:12})},delivered:{label:"Yan�t Al�nd�",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(J,{size:12})},failed:{label:"Hata",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(le,{size:12})}},_=te[Y]||te.draft;return e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${_.color}`,children:[_.icon,_.label]}),((S=t.eInvoiceMeta)==null?void 0:S.uuid)&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-neutral-500",children:[e.jsx(ce,{size:11}),t.eInvoiceMeta.uuid.slice(0,8),"..."]}),((j=t.eInvoiceMeta)==null?void 0:j.ettn)&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-neutral-500",children:[e.jsx(ce,{size:11}),t.eInvoiceMeta.ettn]})]})}const n=t.eDocumentStatus;if(!n)return null;const i={pending:{label:"Bekliyor",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(re,{size:12})},sent:{label:"G�nderildi",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(Q,{size:12})},delivered:{label:"Teslim Edildi",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(J,{size:12})},failed:{label:"Ba�ar�s�z",color:"bg-neutral-100 text-neutral-800",icon:e.jsx(le,{size:12})}},h=i[n]||i.pending;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${h.color}`,children:[h.icon,h.label]})},$={total:a.length,eFatura:a.filter(n=>n.invoiceType==="e-fatura").length,eArsiv:a.filter(n=>n.invoiceType==="e-arsiv").length,totalAmount:a.reduce((n,i)=>n+i.grandTotal,0),paidAmount:a.reduce((n,i)=>n+i.paidAmount,0),unpaid:a.filter(n=>n.status!=="paid"&&n.status!=="cancelled").length};return ee?e.jsx(Le,{onClose:()=>G(!1),onSuccess:()=>{G(!1),k()}}):q&&P?e.jsx(Be,{invoice:P,onBack:()=>{L(!1),D(null)},onUpdate:k}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`${(R=(K=M)==null?void 0:K.typography)==null?void 0:R.h2} ${(Z=(I=M)==null?void 0:I.colors)==null?void 0:Z.text.primary}`,children:"E-Fatura & E-Ar�iv"}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"Elektronik belge y�netimi"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>k(),className:"flex items-center gap-2 px-4 py-2 bg-white border border-neutral-300 text-neutral-700 rounded-xl hover:bg-neutral-50 transition-colors",children:[e.jsx(ne,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Yenile"})]}),e.jsxs("button",{onClick:()=>G(!0),className:"flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-xl hover:bg-neutral-800 transition-colors",children:[e.jsx(Se,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Yeni Fatura"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:H(O("md","sm","subtle","lg"),"bg-white border-neutral-200"),children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(ae,{className:"text-neutral-900",size:20})}),e.jsx("h3",{className:`${(ue=(de=M)==null?void 0:de.typography)==null?void 0:ue.stat.md} text-neutral-900`,children:$.total}),e.jsx("p",{className:"text-xs text-neutral-800",children:"Toplam Fatura"})]}),e.jsxs("div",{className:H(O("md","sm","subtle","lg"),"bg-white border-neutral-200"),children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(Te,{className:"text-neutral-900",size:20})}),e.jsx("h3",{className:`${(me=(xe=M)==null?void 0:xe.typography)==null?void 0:me.stat.md} text-neutral-900`,children:$.eFatura}),e.jsx("p",{className:"text-xs text-neutral-800",children:"E-Fatura"})]}),e.jsxs("div",{className:H(O("md","sm","subtle","lg"),"bg-white border-neutral-200"),children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(ke,{className:"text-neutral-900",size:20})}),e.jsx("h3",{className:`${(pe=(he=M)==null?void 0:he.typography)==null?void 0:pe.stat.md} text-neutral-900`,children:$.eArsiv}),e.jsx("p",{className:"text-xs text-neutral-800",children:"E-Ar�iv"})]}),e.jsxs("div",{className:H(O("md","sm","subtle","lg"),"bg-white border-neutral-200"),children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(Ce,{className:"text-neutral-900",size:20})}),e.jsx("h3",{className:`${(ge=(be=M)==null?void 0:be.typography)==null?void 0:ge.stat.sm} font-bold text-neutral-900`,children:s($.totalAmount)}),e.jsx("p",{className:"text-xs text-neutral-800",children:"Toplam Tutar"})]}),e.jsxs("div",{className:H(O("md","sm","subtle","lg"),"bg-white border-neutral-200"),children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(J,{className:"text-emerald-600",size:20})}),e.jsx("h3",{className:`${(je=(fe=M)==null?void 0:fe.typography)==null?void 0:je.stat.sm} font-bold text-emerald-900`,children:s($.paidAmount)}),e.jsx("p",{className:"text-xs text-emerald-700",children:"Tahsil Edilen"})]}),e.jsxs("div",{className:H(O("md","sm","subtle","lg"),"bg-white border-neutral-200"),children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(re,{className:"text-neutral-900",size:20})}),e.jsx("h3",{className:`${(ye=(Ne=M)==null?void 0:Ne.typography)==null?void 0:ye.stat.md} text-orange-900`,children:$.unpaid}),e.jsx("p",{className:"text-xs text-neutral-800",children:"�denmemi�"})]})]}),e.jsx("div",{className:O("md","sm","default","lg"),children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400",size:20}),e.jsx("input",{type:"text",placeholder:"Fatura no, m��teri, vergi no ara...",value:g,onChange:t=>b(t.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-neutral-50 border border-neutral-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent"})]})}),e.jsxs("select",{value:F,onChange:t=>v(t.target.value),className:Fe("md","default",void 0,"md"),children:[e.jsx("option",{value:"all",children:"T�m Tipler"}),e.jsx("option",{value:"e-fatura",children:"E-Fatura"}),e.jsx("option",{value:"e-arsiv",children:"E-Ar�iv"})]}),e.jsxs("select",{value:E,onChange:t=>W(t.target.value),className:Fe("md","default",void 0,"md"),children:[e.jsx("option",{value:"all",children:"T�m Durumlar"}),e.jsx("option",{value:"draft",children:"Taslak"}),e.jsx("option",{value:"sent",children:"G�nderildi"}),e.jsx("option",{value:"approved",children:"Onayland�"}),e.jsx("option",{value:"cancelled",children:"�ptal"})]})]})}),e.jsx("div",{className:H(O("md","none","default","lg"),"overflow-hidden"),children:w?e.jsx("div",{className:"p-12 text-center text-neutral-600",children:"Y�kleniyor..."}):o.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(ae,{className:"mx-auto text-neutral-400 mb-3",size:48}),e.jsx("p",{className:"text-neutral-600",children:g||F!=="all"||E!=="all"?"Arama kriterlerine uygun fatura bulunamad�":"Hen�z fatura bulunmuyor"}),e.jsx("button",{onClick:()=>G(!0),className:"mt-4 px-4 py-2 bg-neutral-900 text-white rounded-xl hover:bg-neutral-800 transition-colors",children:"�lk Faturay� Olu�tur"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[1100px]",children:[e.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-neutral-700 uppercase tracking-wider",children:"Fatura Bilgileri"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-neutral-700 uppercase tracking-wider",children:"M��teri"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-neutral-700 uppercase tracking-wider",children:"Tip"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-neutral-700 uppercase tracking-wider",children:"Tutar"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-neutral-700 uppercase tracking-wider",children:"Durum"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-neutral-700 uppercase tracking-wider",children:"E-Belge"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-neutral-700 uppercase tracking-wider",children:"��lemler"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-neutral-200",children:o.map(t=>e.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-neutral-900",children:["#",t.invoiceNumber]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-neutral-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(oe,{size:12}),l(t.issueDate)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(re,{size:12}),"Vade: ",l(t.dueDate)]})]}),t.parasutInvoiceNo&&e.jsxs("div",{className:"text-xs text-neutral-900 mt-1 flex items-center gap-1",children:[e.jsx(Ie,{size:12}),"Para��t: ",t.parasutInvoiceNo]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-neutral-900",children:t.customerName}),t.customerTaxNumber&&e.jsxs("div",{className:"text-xs text-neutral-600 mt-1",children:["VN: ",t.customerTaxNumber]})]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium ${t.invoiceType==="e-fatura"?"bg-neutral-100 text-neutral-800":"bg-neutral-50 text-neutral-800"}`,children:[t.invoiceType==="e-fatura"?e.jsx(Te,{size:12}):e.jsx(ke,{size:12}),t.invoiceType==="e-fatura"?"E-Fatura":"E-Ar�iv"]})}),e.jsxs("td",{className:"px-6 py-4 text-right",children:[e.jsx("div",{className:"font-bold text-neutral-900",children:s(t.grandTotal)}),t.paidAmount>0&&e.jsxs("div",{className:"text-xs text-neutral-900 mt-1",children:["�denen: ",s(t.paidAmount)]})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:B(t.status)}),e.jsx("td",{className:"px-6 py-4 text-center",children:V(t)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>{D(t),L(!0)},className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",title:"Detay",children:e.jsx(Pe,{size:18,className:"text-neutral-600"})}),t.status==="draft"&&e.jsx("button",{onClick:()=>r(t),disabled:T===t.id,className:"p-2 hover:bg-neutral-50 rounded-lg transition-colors disabled:opacity-50 disabled:pointer-events-none",title:"E-Belge G�nder",children:e.jsx(Q,{size:18,className:"text-neutral-900"})}),t.invoiceType==="e-fatura"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>x(t),disabled:T===t.id,className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors disabled:opacity-50 disabled:pointer-events-none",title:"G�B Durumunu Sorgula",children:e.jsx(ne,{size:18,className:"text-neutral-600"})}),e.jsx("button",{onClick:()=>m(t),disabled:T===t.id,className:"p-2 hover:bg-neutral-50 rounded-lg transition-colors disabled:opacity-50 disabled:pointer-events-none",title:"E-Fatura XML �ndir",children:e.jsx(se,{size:18,className:"text-neutral-900"})})]}),t.parasutId&&e.jsx("button",{onClick:()=>N(),disabled:T===t.id,className:"p-2 hover:bg-neutral-50 rounded-lg transition-colors disabled:opacity-50 disabled:pointer-events-none",title:"PDF �ndir",children:e.jsx(ze,{size:18,className:"text-neutral-900"})}),t.status!=="cancelled"&&t.status!=="paid"&&e.jsx("button",{onClick:()=>d(t),disabled:T===t.id,className:"p-2 hover:bg-neutral-50 rounded-lg transition-colors disabled:opacity-50 disabled:pointer-events-none",title:"�ptal Et",children:e.jsx(ie,{size:18,className:"text-neutral-900"})})]})})]},t.id))})]})})}),!w&&o.length>0&&e.jsxs("div",{className:"text-sm text-neutral-600 text-center",children:[o.length," fatura g�steriliyor",a.length!==o.length&&` (toplam ${a.length} fatura)`]})]})}export{Xe as default};

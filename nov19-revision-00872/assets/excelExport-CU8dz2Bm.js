import{u as t,w as h}from"./xlsx-DrgRuPKf.js";function k(l,r,o="Sheet1"){try{const e=t.json_to_sheet(l),a=t.book_new();t.book_append_sheet(a,e,o),h(a,`${r}.xlsx`)}catch(e){throw console.error("Excel export error:",e),new Error("Excel export failed")}}function B(l,r,o){const e=l.map(s=>({"Hesap Kodu":s.accountCode,"Hesap Adı":s.accountName,Tip:s.accountType,Borç:s.debit,Alacak:s.credit,Bakiye:s.debit-s.credit}));e.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM",Tip:"",Borç:r.totalDebit,Alacak:r.totalCredit,Bakiye:r.difference});const a=`Mizan_${o.from||"Baslangic"}_${o.to}`;k(e,a,"Mizan")}function L(l,r,o,e){const a=l.map(i=>({"Hesap Kodu":i.accountCode,"Hesap Adı":i.accountName,Tutar:i.amount,Yüzde:`${i.percentage.toFixed(2)}%`}));a.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM GELİR",Tutar:o.totalRevenue,Yüzde:"100.00%"});const s=r.map(i=>({"Hesap Kodu":i.accountCode,"Hesap Adı":i.accountName,Tutar:i.amount,Yüzde:`${i.percentage.toFixed(2)}%`}));s.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM GİDER",Tutar:o.totalExpense,Yüzde:"100.00%"});const c=[{Açıklama:"Toplam Gelir",Tutar:o.totalRevenue},{Açıklama:"Toplam Gider",Tutar:o.totalExpense},{Açıklama:"Brüt Kar/Zarar",Tutar:o.grossProfit},{Açıklama:"Net Kar/Zarar",Tutar:o.netProfit},{Açıklama:"Kar Marjı (%)",Tutar:o.profitMargin}],n=t.book_new(),u=t.json_to_sheet(a);t.book_append_sheet(n,u,"Gelirler");const T=t.json_to_sheet(s);t.book_append_sheet(n,T,"Giderler");const p=t.json_to_sheet(c);t.book_append_sheet(n,p,"Özet");const A=`Gelir_Gider_Tablosu_${e.from}_${e.to}`;h(n,`${A}.xlsx`)}function D(l,r,o,e,a){const s=(x,b="")=>{const _=[];return x.forEach(d=>{_.push({"Hesap Kodu":d.accountCode,"Hesap Adı":b+d.accountName,Tutar:d.amount,Yüzde:`${d.percentage.toFixed(2)}%`}),d.children&&d.children.length>0&&_.push(...s(d.children,b+"  "))}),_},c=s(l);c.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM VARLIKLAR",Tutar:e.totalAssets,Yüzde:"100.00%"});const n=s(r);n.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM BORÇLAR",Tutar:e.totalLiabilities,Yüzde:`${(e.totalLiabilities/e.totalLiabilitiesAndEquity*100).toFixed(2)}%`});const u=s(o);u.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM ÖZKAYNAK",Tutar:e.totalEquity,Yüzde:`${(e.totalEquity/e.totalLiabilitiesAndEquity*100).toFixed(2)}%`});const T=[{Açıklama:"Toplam Varlıklar",Tutar:e.totalAssets},{Açıklama:"Toplam Borçlar",Tutar:e.totalLiabilities},{Açıklama:"Toplam Özkaynak",Tutar:e.totalEquity},{Açıklama:"Borç + Özkaynak",Tutar:e.totalLiabilitiesAndEquity},{Açıklama:"Fark",Tutar:e.difference},{Açıklama:"Dengede",Tutar:e.isBalanced?"EVET":"HAYIR"}],p=t.book_new(),A=t.json_to_sheet(c);t.book_append_sheet(p,A,"Varlıklar");const i=t.json_to_sheet(n);t.book_append_sheet(p,i,"Borçlar");const f=t.json_to_sheet(u);t.book_append_sheet(p,f,"Özkaynak");const E=t.json_to_sheet(T);t.book_append_sheet(p,E,"Özet");const H=`Bilanco_${a}`;h(p,`${H}.xlsx`)}function K(l){const r=(a,s=0)=>{const c=[];return a.forEach(n=>{c.push({"Hesap Kodu":n.code,"Hesap Adı":"  ".repeat(s)+n.name,Tip:n.type,Bakiye:n.balance||0,Durum:n.isActive?"Aktif":"Pasif"}),n.children&&n.children.length>0&&c.push(...r(n.children,s+1))}),c},o=r(l),e=`Hesap_Plani_${new Date().toISOString().split("T")[0]}`;k(o,e,"Hesap Planı")}function $(l,r){const o=r.map(a=>({Tarih:new Date(a.date).toLocaleDateString("tr-TR"),Açıklama:a.description,"Fatura No":a.invoiceNumber||"","Ödeme Yöntemi":a.paymentMethod||"",Borç:a.type==="DEBIT"?a.amount:"",Alacak:a.type==="CREDIT"?a.amount:"",Bakiye:a.balance})),e=`Cari_Ekstre_${l.code}_${new Date().toISOString().split("T")[0]}`;k(o,e,`${l.name} Ekstresi`)}export{B as a,L as b,D as c,$ as d,K as e};

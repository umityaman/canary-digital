import{r,j as e,a as E}from"./react-vendor-DBHNAGPW.js";import{u as A}from"./customerStore-Cl2_vzy7.js";import{X as D,o as q,ac as B,e as T,ax as P,Q as I,aa as Y,ay as L,ao as O,ap as U}from"./ui-vendor-CIs_GH3f.js";import"./chart-vendor-R5Y1AjBI.js";import"./state-vendor-JOdu_MDH.js";import"./index-C00KFl1S.js";const V=({isOpen:m,onClose:i,onSave:g,customer:c,mode:d})=>{const[s,l]=r.useState({name:"",email:"",phone:"",address:"",company:"",taxNumber:""}),[o,u]=r.useState(!1),[p,x]=r.useState(null);r.useEffect(()=>{l(c&&d==="edit"?c:{name:"",email:"",phone:"",address:"",company:"",taxNumber:""})},[c,d,m]);const h=async a=>{var f,n;if(a.preventDefault(),x(null),!s.name.trim()){x("Müşteri adı zorunludur");return}u(!0);try{await g(s),i()}catch(b){x(((n=(f=b.response)==null?void 0:f.data)==null?void 0:n.error)||"Bir hata oluştu")}finally{u(!1)}};return m?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:d==="create"?"Yeni Müşteri Ekle":"Müşteri Düzenle"}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-neutral-600 transition-colors",children:e.jsx(D,{size:24})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[p&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:p}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["Müşteri Adı ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.name,onChange:a=>l({...s,name:a.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-neutral-500",placeholder:"Ahmet Yılmaz",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"E-posta"}),e.jsx("input",{type:"email",value:s.email,onChange:a=>l({...s,email:a.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-neutral-500",placeholder:"ornek@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Telefon"}),e.jsx("input",{type:"tel",value:s.phone,onChange:a=>l({...s,phone:a.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-neutral-500",placeholder:"+90 555 123 45 67"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Şirket Adı"}),e.jsx("input",{type:"text",value:s.company,onChange:a=>l({...s,company:a.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-neutral-500",placeholder:"ABC Ltd. Şti."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Vergi No"}),e.jsx("input",{type:"text",value:s.taxNumber,onChange:a=>l({...s,taxNumber:a.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-neutral-500",placeholder:"1234567890"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Adres"}),e.jsx("textarea",{value:s.address,onChange:a=>l({...s,address:a.target.value}),rows:3,className:"w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-neutral-500",placeholder:"Tam adres..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-neutral-700 bg-neutral-100 rounded-md hover:bg-neutral-200 transition-colors",disabled:o,children:"İptal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-neutral-900 rounded-md hover:bg-neutral-800 transition-colors disabled:opacity-50",disabled:o,children:o?"Kaydediliyor...":d==="create"?"Ekle":"Güncelle"})]})]})]})}):null},R=()=>{const m=E(),{customers:i,loading:g,error:c,fetchCustomers:d,createCustomer:s,updateCustomer:l,deleteCustomer:o}=A(),[u,p]=r.useState(""),[x,h]=r.useState(!1),[a,f]=r.useState("create"),[n,b]=r.useState(null);r.useEffect(()=>{d()},[]);const w=t=>{p(t),d(t)},N=()=>{m("/customers/create")},k=t=>{b(t),f("edit"),h(!0)},C=async(t,j)=>{var y,v;if(window.confirm(`"${j}" müşterisini silmek istediğinizden emin misiniz?`))try{await o(t)}catch(M){alert(((v=(y=M.response)==null?void 0:y.data)==null?void 0:v.error)||"Müşteri silinemedi")}},z=async t=>{a==="create"?await s(t):n!=null&&n.id&&await l(n.id,t)},S=()=>{h(!1),b(null)};return g&&i.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-neutral-900 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-neutral-600",children:"Müşteriler yükleniyor..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Müşteri ara (isim, email, telefon, şirket)...",value:u,onChange:t=>w(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900"})]}),e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-lg hover:bg-neutral-800 transition-colors whitespace-nowrap",children:[e.jsx(B,{size:20}),"Yeni Müşteri"]})]}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-600",children:c})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(T,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-500 text-lg",children:"Henüz müşteri bulunmuyor"}),e.jsx("button",{onClick:N,className:"mt-4 text-neutral-900 hover:text-neutral-700 font-medium",children:"İlk müşterinizi ekleyin"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-neutral-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Müşteri"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"İletişim"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Şirket"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sipariş"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"İşlemler"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(t=>{var j;return e.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-neutral-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-neutral-700 font-semibold",children:t.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-900",children:t.name}),t.booqableId&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",title:`Booqable ID: ${t.booqableId}`,children:[e.jsx(P,{size:12}),e.jsx("span",{children:"Booqable"})]})]}),t.taxNumber&&e.jsxs("div",{className:"text-sm text-gray-500",children:["VN: ",t.taxNumber]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"space-y-1",children:[t.email&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(I,{size:14,className:"mr-1"}),t.email]}),t.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Y,{size:14,className:"mr-1"}),t.phone]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.company?e.jsxs("div",{className:"flex items-center text-sm text-neutral-900",children:[e.jsx(L,{size:14,className:"mr-1 text-gray-400"}),t.company]}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"px-2 py-1 text-xs bg-neutral-100 text-neutral-900 rounded-full",children:[((j=t.orders)==null?void 0:j.length)||0," sipariş"]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>k(t),className:"text-blue-600 hover:text-blue-900 mr-3",title:"Düzenle",children:e.jsx(O,{size:18})}),e.jsx("button",{onClick:()=>C(t.id,t.name),className:"text-red-600 hover:text-red-900",title:"Sil",children:e.jsx(U,{size:18})})]})]},t.id)})})]})})}),e.jsx(V,{isOpen:x,onClose:S,onSave:z,customer:n,mode:a})]})};export{R as default};

import{c as g}from"./state-vendor-JOdu_MDH.js";import{b as p}from"./index-C00KFl1S.js";class I{async getInspections(e){const n=new URLSearchParams;return e!=null&&e.search&&n.append("search",e.search),e!=null&&e.inspectionType&&e.inspectionType!=="ALL"&&n.append("inspectionType",e.inspectionType),e!=null&&e.status&&e.status!=="ALL"&&n.append("status",e.status),e!=null&&e.dateFrom&&n.append("dateFrom",e.dateFrom),e!=null&&e.dateTo&&n.append("dateTo",e.dateTo),e!=null&&e.equipmentId&&n.append("equipmentId",e.equipmentId.toString()),e!=null&&e.customerId&&n.append("customerId",e.customerId.toString()),(await p.get(`/inspections?${n.toString()}`)).data}async getInspection(e){return(await p.get(`/inspections/${e}`)).data}async getInspectionsByOrder(e){return(await p.get(`/inspections/order/${e}`)).data}async createInspection(e){return(await p.post("/inspections",e)).data}async updateInspection(e,n){return(await p.put(`/inspections/${e}`,n)).data}async deleteInspection(e){await p.delete(`/inspections/${e}`)}async uploadPhoto(e,n){return(await p.post(`/inspections/${e}/photos`,n)).data}async deletePhoto(e,n){await p.delete(`/inspections/${e}/photos/${n}`)}async addDamageReport(e,n){return(await p.post(`/inspections/${e}/damages`,n)).data}async updateDamageReport(e,n,t){return(await p.put(`/inspections/${e}/damages/${n}`,t)).data}async deleteDamageReport(e,n){await p.delete(`/inspections/${e}/damages/${n}`)}async saveSignature(e,n,t){const o=t==="customer"?"customerSignature":"inspectorSignature";return(await p.put(`/inspections/${e}`,{[o]:n})).data}async generatePDF(e){return(await p.get(`/inspections/${e}/pdf`,{responseType:"blob"})).data}}const d=new I,m=g(a=>({inspections:[],selectedInspection:null,loading:!1,error:null,fetchInspections:async e=>{var n,t;a({loading:!0,error:null});try{const o=await d.getInspections(e);a({inspections:o,loading:!1})}catch(o){a({error:((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.error)||"Kontroller yüklenirken hata oluştu",loading:!1})}},getInspection:async e=>{var n,t;a({loading:!0,error:null});try{const o=await d.getInspection(e);a({selectedInspection:o,loading:!1})}catch(o){a({error:((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.error)||"Kontrol yüklenirken hata oluştu",loading:!1})}},getInspectionsByOrder:async e=>{var n,t;a({loading:!0,error:null});try{const o=await d.getInspectionsByOrder(e);a({inspections:o,loading:!1})}catch(o){a({error:((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.error)||"Kontroller yüklenirken hata oluştu",loading:!1})}},createInspection:async e=>{var n,t;a({loading:!0,error:null});try{const o=await d.createInspection(e);return a(r=>({inspections:[o,...r.inspections],selectedInspection:o,loading:!1})),o}catch(o){throw a({error:((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.error)||"Kontrol oluşturulurken hata oluştu",loading:!1}),o}},updateInspection:async(e,n)=>{var t,o;a({loading:!0,error:null});try{const r=await d.updateInspection(e,n);return a(s=>{var c;return{inspections:s.inspections.map(i=>i.id===e?r:i),selectedInspection:((c=s.selectedInspection)==null?void 0:c.id)===e?r:s.selectedInspection,loading:!1}}),r}catch(r){throw a({error:((o=(t=r.response)==null?void 0:t.data)==null?void 0:o.error)||"Kontrol güncellenirken hata oluştu",loading:!1}),r}},deleteInspection:async e=>{var n,t;a({loading:!0,error:null});try{await d.deleteInspection(e),a(o=>{var r;return{inspections:o.inspections.filter(s=>s.id!==e),selectedInspection:((r=o.selectedInspection)==null?void 0:r.id)===e?null:o.selectedInspection,loading:!1}})}catch(o){throw a({error:((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.error)||"Kontrol silinirken hata oluştu",loading:!1}),o}},uploadPhoto:async(e,n)=>{var t,o;try{const r=await d.uploadPhoto(e,n);return a(s=>{var c;return((c=s.selectedInspection)==null?void 0:c.id)===e?{selectedInspection:{...s.selectedInspection,photos:[...s.selectedInspection.photos||[],r]}}:s}),r}catch(r){throw a({error:((o=(t=r.response)==null?void 0:t.data)==null?void 0:o.error)||"Fotoğraf yüklenirken hata oluştu"}),r}},deletePhoto:async(e,n)=>{var t,o;try{await d.deletePhoto(e,n),a(r=>{var s,c;return((s=r.selectedInspection)==null?void 0:s.id)===e?{selectedInspection:{...r.selectedInspection,photos:(c=r.selectedInspection.photos)==null?void 0:c.filter(i=>i.id!==n)}}:r})}catch(r){throw a({error:((o=(t=r.response)==null?void 0:t.data)==null?void 0:o.error)||"Fotoğraf silinirken hata oluştu"}),r}},addDamageReport:async(e,n)=>{var t,o;try{const r=await d.addDamageReport(e,n);return a(s=>{var c;return((c=s.selectedInspection)==null?void 0:c.id)===e?{selectedInspection:{...s.selectedInspection,damageReports:[...s.selectedInspection.damageReports||[],r],status:"DAMAGE_FOUND"}}:s}),r}catch(r){throw a({error:((o=(t=r.response)==null?void 0:t.data)==null?void 0:o.error)||"Hasar raporu eklenirken hata oluştu"}),r}},updateDamageReport:async(e,n,t)=>{var o,r;try{const s=await d.updateDamageReport(e,n,t);return a(c=>{var i,u;return((i=c.selectedInspection)==null?void 0:i.id)===e?{selectedInspection:{...c.selectedInspection,damageReports:(u=c.selectedInspection.damageReports)==null?void 0:u.map(l=>l.id===n?s:l)}}:c}),s}catch(s){throw a({error:((r=(o=s.response)==null?void 0:o.data)==null?void 0:r.error)||"Hasar raporu güncellenirken hata oluştu"}),s}},deleteDamageReport:async(e,n)=>{var t,o;try{await d.deleteDamageReport(e,n),a(r=>{var s,c;return((s=r.selectedInspection)==null?void 0:s.id)===e?{selectedInspection:{...r.selectedInspection,damageReports:(c=r.selectedInspection.damageReports)==null?void 0:c.filter(i=>i.id!==n)}}:r})}catch(r){throw a({error:((o=(t=r.response)==null?void 0:t.data)==null?void 0:o.error)||"Hasar raporu silinirken hata oluştu"}),r}},saveSignature:async(e,n,t)=>{var o,r;try{const s=await d.saveSignature(e,n,t);a(c=>{var i;return{selectedInspection:((i=c.selectedInspection)==null?void 0:i.id)===e?s:c.selectedInspection}})}catch(s){throw a({error:((r=(o=s.response)==null?void 0:o.data)==null?void 0:r.error)||"İmza kaydedilirken hata oluştu"}),s}},setSelectedInspection:e=>{a({selectedInspection:e})},clearError:()=>{a({error:null})}}));export{d as i,m as u};

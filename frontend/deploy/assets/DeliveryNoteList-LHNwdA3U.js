import{a as se,r as c,j as e,z as d}from"./react-vendor-DBHNAGPW.js";import{b as n}from"./index-C00KFl1S.js";import{D as o,c as N,b as f,a as p,i as te,d as K}from"./index-C5wiI25D.js";import{P as b,ac as ae,u as le,C as re,F as X,ag as ne,a0 as ie,T as ce,a as de}from"./ui-vendor-CIs_GH3f.js";import"./chart-vendor-R5Y1AjBI.js";import"./state-vendor-JOdu_MDH.js";const h={async getAll(t){return(await n.get("/delivery-notes",{params:t})).data},async getById(t){return(await n.get(`/delivery-notes/${t}`)).data},async create(t){return(await n.post("/delivery-notes",t)).data},async update(t,a){return(await n.patch(`/delivery-notes/${t}`,a)).data},async delete(t){return(await n.delete(`/delivery-notes/${t}`)).data},async markAsDelivered(t){return(await n.post(`/delivery-notes/${t}/deliver`)).data},async cancel(t){return(await n.post(`/delivery-notes/${t}/cancel`)).data},async convertToInvoice(t,a){return(await n.post(`/delivery-notes/${t}/convert-to-invoice`,a)).data},async downloadPDF(t){const a=await n.get(`/delivery-notes/${t}/pdf`,{responseType:"blob"}),x=window.URL.createObjectURL(new Blob([a.data])),m=document.createElement("a");m.href=x,m.setAttribute("download",`irsaliye-${t}.pdf`),document.body.appendChild(m),m.click(),m.remove(),window.URL.revokeObjectURL(x)},async getStatistics(t){return(await n.get("/delivery-notes/statistics/summary",{params:t})).data}},oe={pending:"warning",delivered:"success",invoiced:"info",cancelled:"danger"},me={pending:"Beklemede",delivered:"Teslim Edildi",invoiced:"Faturalandı",cancelled:"İptal"};function ve(){var S,$,E,P,L,R,B,A,I,O,U,M,G,H,Y,q;const t=se(),[a,x]=c.useState([]),[m,w]=c.useState(!0),[k,D]=c.useState(null),[j,_]=c.useState(""),[u,T]=c.useState(null),[J,v]=c.useState(!1),[g,C]=c.useState(!1);c.useEffect(()=>{y()},[j]);const y=async()=>{var s,r;try{w(!0),D(null);const l=await h.getAll({status:j||void 0});x(l.data)}catch(l){D(((r=(s=l.response)==null?void 0:s.data)==null?void 0:r.message)||"İrsaliyeler yüklenirken hata oluştu")}finally{w(!1)}},Q=async s=>{var r,l;try{await h.downloadPDF(s),d.success("PDF indiriliyor...")}catch(i){d.error("PDF indirilemedi: "+(((l=(r=i.response)==null?void 0:r.data)==null?void 0:l.message)||i.message))}},V=async()=>{var s,r;if(u)try{C(!0),await h.convertToInvoice(u.id),v(!1),T(null),await y(),d.success("İrsaliye başarıyla faturaya dönüştürüldü!")}catch(l){d.error("Faturaya dönüştürülürken hata: "+(((r=(s=l.response)==null?void 0:s.data)==null?void 0:r.message)||l.message))}finally{C(!1)}},W=async s=>{var r,l;if(confirm("Bu irsaliyeyi teslim edildi olarak işaretlemek istediğinizden emin misiniz?"))try{await h.markAsDelivered(s),await y(),d.success("İrsaliye teslim edildi olarak işaretlendi")}catch(i){d.error("Hata: "+(((l=(r=i.response)==null?void 0:r.data)==null?void 0:l.message)||i.message))}},Z=async s=>{var r,l;if(confirm("Bu irsaliyeyi iptal etmek istediğinizden emin misiniz?"))try{await h.cancel(s),await y(),d.success("İrsaliye iptal edildi")}catch(i){d.error("Hata: "+(((l=(r=i.response)==null?void 0:r.data)==null?void 0:l.message)||i.message))}},ee=s=>new Date(s).toLocaleDateString("tr-TR"),z=s=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(s),F=s=>s.items.reduce((r,l)=>r+l.quantity*l.unitPrice,0);return m?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-neutral-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`${($=(S=o)==null?void 0:S.typography)==null?void 0:$.h1} ${(P=(E=o)==null?void 0:E.colors)==null?void 0:P.text.primary} flex items-center gap-3`,children:[e.jsx(b,{className:"w-8 h-8 text-blue-600"}),"İrsaliyeler"]}),e.jsx("p",{className:`${(R=(L=o)==null?void 0:L.typography)==null?void 0:R.body.md} ${(A=(B=o)==null?void 0:B.colors)==null?void 0:A.text.secondary} mt-1`,children:"Sevk ve tahsilat irsaliyelerini yönetin"})]}),e.jsxs("button",{onClick:()=>t("/delivery-notes/new"),className:N(f("md","primary","md"),"gap-2"),children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Yeni İrsaliye"})]})]}),k&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:e.jsx("p",{className:"text-red-800 text-sm",children:k})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:p("md","lg","default","xl"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Toplam"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-1",children:a.length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(b,{className:"text-blue-600",size:24})})]})}),e.jsx("div",{className:p("md","lg","default","xl"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Beklemede"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:a.filter(s=>s.status==="pending").length})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center",children:e.jsx(le,{className:"text-orange-600",size:24})})]})}),e.jsx("div",{className:p("md","lg","default","xl"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Teslim Edildi"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:a.filter(s=>s.status==="delivered").length})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(re,{className:"text-green-600",size:24})})]})}),e.jsx("div",{className:p("md","lg","default","xl"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Faturalandı"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:a.filter(s=>s.status==="invoiced").length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(X,{className:"text-blue-600",size:24})})]})})]}),e.jsx("div",{className:p("md","lg","default","xl"),children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:N((O=(I=o)==null?void 0:I.typography)==null?void 0:O.label.lg,(M=(U=o)==null?void 0:U.colors)==null?void 0:M.text.secondary,"block mb-2"),children:"Durum Filtrele"}),e.jsxs("select",{value:j,onChange:s=>_(s.target.value),className:te("md","default",void 0,"md"),children:[e.jsx("option",{value:"",children:"Tümü"}),e.jsx("option",{value:"pending",children:"Beklemede"}),e.jsx("option",{value:"delivered",children:"Teslim Edildi"}),e.jsx("option",{value:"invoiced",children:"Faturalandı"}),e.jsx("option",{value:"cancelled",children:"İptal"})]})]})})}),e.jsx("div",{className:p("none","none","default","xl"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-700 uppercase",children:"İrsaliye No"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-700 uppercase hidden lg:table-cell",children:"Tarih"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-700 uppercase",children:"Müşteri"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-700 uppercase hidden md:table-cell",children:"Tip"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"Tutar"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-neutral-700 uppercase",children:"Durum"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"İşlemler"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center",children:[e.jsx(b,{className:"mx-auto mb-3 text-gray-400",size:48}),e.jsx("p",{className:"text-neutral-600",children:"İrsaliye bulunamadı"})]})}):a.map(s=>e.jsxs("tr",{className:"hover:bg-neutral-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-neutral-900",children:s.deliveryNumber})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-neutral-600 hidden lg:table-cell",children:ee(s.deliveryDate)}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"font-medium text-neutral-900",children:s.customer.name})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap hidden md:table-cell",children:e.jsx("span",{className:K("sm","default"),children:s.deliveryType==="sevk"?"Sevk":"Tahsilat"})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right font-medium text-neutral-900",children:z(F(s))}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:K("sm",oe[s.status]||"default"),children:me[s.status]||s.status})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>t(`/delivery-notes/${s.id}`),className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",title:"Görüntüle",children:e.jsx(ne,{className:"text-neutral-600",size:16})}),e.jsx("button",{onClick:()=>Q(s.id),className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",title:"PDF İndir",children:e.jsx(ie,{className:"text-neutral-600",size:16})}),s.status==="pending"&&e.jsx("button",{onClick:()=>W(s.id),className:"p-2 hover:bg-green-100 rounded-lg transition-colors",title:"Teslim Edildi",children:e.jsx(ce,{className:"text-green-600",size:16})}),(s.status==="pending"||s.status==="delivered")&&!s.invoice&&e.jsx("button",{onClick:()=>{T(s),v(!0)},className:"p-2 hover:bg-blue-100 rounded-lg transition-colors",title:"Faturaya Dönüştür",children:e.jsx(X,{className:"text-blue-600",size:16})}),s.status==="pending"&&e.jsx("button",{onClick:()=>Z(s.id),className:"p-2 hover:bg-red-100 rounded-lg transition-colors",title:"İptal",children:e.jsx(de,{className:"text-red-600",size:16})})]})})]},s.id))})]})})}),J&&u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:`${(H=(G=o)==null?void 0:G.typography)==null?void 0:H.h3} ${(q=(Y=o)==null?void 0:Y.colors)==null?void 0:q.text.primary} mb-4`,children:"Faturaya Dönüştür"}),e.jsxs("p",{className:"text-neutral-600 mb-4",children:[e.jsx("strong",{children:u.deliveryNumber})," numaralı irsaliyeyi faturaya dönüştürmek istediğinizden emin misiniz?"]}),e.jsxs("div",{className:"bg-neutral-50 rounded-lg p-4 mb-6",children:[e.jsxs("p",{className:"text-sm text-neutral-600",children:["Müşteri: ",u.customer.name]}),e.jsxs("p",{className:"text-sm text-neutral-600 mt-1",children:["Tutar: ",z(F(u))]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>v(!1),className:f("md","outline","md"),disabled:g,children:"İptal"}),e.jsx("button",{onClick:V,className:N(f("md","primary","md"),"flex-1"),disabled:g,children:g?"Dönüştürülüyor...":"Faturaya Dönüştür"})]})]})})]})}export{ve as default};

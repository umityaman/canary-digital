import{u as o,w as h}from"./xlsx-DrgRuPKf.js";function T(i,n,t="Sheet1"){try{const e=o.json_to_sheet(i),a=o.book_new();o.book_append_sheet(a,e,t),h(a,`${n}.xlsx`)}catch(e){throw console.error("Excel export error:",e),new Error("Excel export failed")}}function B(i,n,t){const e=i.map(s=>({"Hesap Kodu":s.accountCode,"Hesap Adı":s.accountName,Tip:s.accountType,Borç:s.debit,Alacak:s.credit,Bakiye:s.debit-s.credit}));e.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM",Tip:"",Borç:n.totalDebit,Alacak:n.totalCredit,Bakiye:n.difference});const a=`Mizan_${t.from||"Baslangic"}_${t.to}`;T(e,a,"Mizan")}function D(i,n,t,e){const a=i.map(l=>({"Hesap Kodu":l.accountCode,"Hesap Adı":l.accountName,Tutar:l.amount,Yüzde:`${l.percentage.toFixed(2)}%`}));a.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM GELİR",Tutar:t.totalRevenue,Yüzde:"100.00%"});const s=n.map(l=>({"Hesap Kodu":l.accountCode,"Hesap Adı":l.accountName,Tutar:l.amount,Yüzde:`${l.percentage.toFixed(2)}%`}));s.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM GİDER",Tutar:t.totalExpense,Yüzde:"100.00%"});const p=[{Açıklama:"Toplam Gelir",Tutar:t.totalRevenue},{Açıklama:"Toplam Gider",Tutar:t.totalExpense},{Açıklama:"Brüt Kar/Zarar",Tutar:t.grossProfit},{Açıklama:"Net Kar/Zarar",Tutar:t.netProfit},{Açıklama:"Kar Marjı (%)",Tutar:t.profitMargin}],r=o.book_new(),u=o.json_to_sheet(a);o.book_append_sheet(r,u,"Gelirler");const A=o.json_to_sheet(s);o.book_append_sheet(r,A,"Giderler");const d=o.json_to_sheet(p);o.book_append_sheet(r,d,"Özet");const _=`Gelir_Gider_Tablosu_${e.from}_${e.to}`;h(r,`${_}.xlsx`)}function K(i,n,t,e,a){const s=(x,f="")=>{const k=[];return x.forEach(c=>{k.push({"Hesap Kodu":c.accountCode,"Hesap Adı":f+c.accountName,Tutar:c.amount,Yüzde:`${c.percentage.toFixed(2)}%`}),c.children&&c.children.length>0&&k.push(...s(c.children,f+"  "))}),k},p=s(i);p.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM VARLIKLAR",Tutar:e.totalAssets,Yüzde:"100.00%"});const r=s(n);r.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM BORÇLAR",Tutar:e.totalLiabilities,Yüzde:`${(e.totalLiabilities/e.totalLiabilitiesAndEquity*100).toFixed(2)}%`});const u=s(t);u.push({"Hesap Kodu":"","Hesap Adı":"TOPLAM ÖZKAYNAK",Tutar:e.totalEquity,Yüzde:`${(e.totalEquity/e.totalLiabilitiesAndEquity*100).toFixed(2)}%`});const A=[{Açıklama:"Toplam Varlıklar",Tutar:e.totalAssets},{Açıklama:"Toplam Borçlar",Tutar:e.totalLiabilities},{Açıklama:"Toplam Özkaynak",Tutar:e.totalEquity},{Açıklama:"Borç + Özkaynak",Tutar:e.totalLiabilitiesAndEquity},{Açıklama:"Fark",Tutar:e.difference},{Açıklama:"Dengede",Tutar:e.isBalanced?"EVET":"HAYIR"}],d=o.book_new(),_=o.json_to_sheet(p);o.book_append_sheet(d,_,"Varlıklar");const l=o.json_to_sheet(r);o.book_append_sheet(d,l,"Borçlar");const b=o.json_to_sheet(u);o.book_append_sheet(d,b,"Özkaynak");const E=o.json_to_sheet(A);o.book_append_sheet(d,E,"Özet");const H=`Bilanco_${a}`;h(d,`${H}.xlsx`)}function L(i){const n=(a,s=0)=>{const p=[];return a.forEach(r=>{p.push({"Hesap Kodu":r.code,"Hesap Adı":"  ".repeat(s)+r.name,Tip:r.type,Bakiye:r.balance||0,Durum:r.isActive?"Aktif":"Pasif"}),r.children&&r.children.length>0&&p.push(...n(r.children,s+1))}),p},t=n(i),e=`Hesap_Plani_${new Date().toISOString().split("T")[0]}`;T(t,e,"Hesap Planı")}function $(i){const n=i.map(e=>({"Cari Kodu":e.code,"Cari Adı":e.name,Tip:e.type==="CUSTOMER"?"Müşteri":"Tedarikçi","Vergi No":e.taxNumber||"",Telefon:e.phone||"",Email:e.email||"",Borç:e.totalDebit,Alacak:e.totalCredit,Bakiye:e.balance,Durum:e.isActive?"Aktif":"Pasif"})),t=`Cari_Hesaplar_${new Date().toISOString().split("T")[0]}`;T(n,t,"Cari Hesaplar")}function C(i,n){const t=n.map(a=>({Tarih:new Date(a.date).toLocaleDateString("tr-TR"),Açıklama:a.description,"Fatura No":a.invoiceNumber||"","Ödeme Yöntemi":a.paymentMethod||"",Borç:a.type==="DEBIT"?a.amount:"",Alacak:a.type==="CREDIT"?a.amount:"",Bakiye:a.balance})),e=`Cari_Ekstre_${i.code}_${new Date().toISOString().split("T")[0]}`;T(t,e,`${i.name} Ekstresi`)}export{$ as a,B as b,D as c,K as d,L as e,C as f};

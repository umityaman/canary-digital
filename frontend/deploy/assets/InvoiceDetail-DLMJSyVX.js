import{o as F,a as T,r as o,z as n,j as e,v as A}from"./react-vendor-DBHNAGPW.js";import{i as u}from"./index-C00KFl1S.js";import{D as C}from"./DetailSkeleton-ZBWuwSwT.js";import{F as h,am as p,h as P,a0 as S,a1 as B,Q as j,a5 as E,ap as I,f as $,u as L,a2 as G,ab as q,a as M,A as K,C as R}from"./ui-vendor-CIs_GH3f.js";import"./chart-vendor-R5Y1AjBI.js";import"./state-vendor-JOdu_MDH.js";function O(){const{id:d}=F(),c=T(),[s,b]=o.useState(null),[g,x]=o.useState(!0);o.useEffect(()=>{d&&N()},[d]);const N=async()=>{var t,l;try{x(!0),console.log("üîç Loading invoice:",d);const a=await u.getById(Number(d));console.log("‚úÖ Invoice loaded:",a.data),b(a.data.data||a.data)}catch(a){console.error("‚ùå Failed to load invoice:",a),n.error("Fatura y√ºklenemedi: "+(((l=(t=a.response)==null?void 0:t.data)==null?void 0:l.message)||a.message)),setTimeout(()=>c("/accounting?tab=invoice"),2e3)}finally{x(!1)}},f=async()=>{var t,l;if(s&&confirm(`${s.invoiceNumber} numaralƒ± faturayƒ± silmek istediƒüinizden emin misiniz?`))try{await u.delete(s.id),n.success("Fatura ba≈üarƒ±yla silindi"),c("/accounting?tab=invoice")}catch(a){console.error("Failed to delete invoice:",a),n.error("Fatura silinemedi: "+(((l=(t=a.response)==null?void 0:t.data)==null?void 0:l.message)||a.message))}},v=()=>{window.print()},y=async()=>{try{n.success("PDF indirme √∂zelliƒüi yakƒ±nda eklenecek")}catch{n.error("PDF indirilemedi")}},w=async()=>{try{n.success("E-posta g√∂nderme √∂zelliƒüi yakƒ±nda eklenecek")}catch{n.error("E-posta g√∂nderilemedi")}},k=async()=>{try{navigator.share?await navigator.share({title:`Fatura ${s==null?void 0:s.invoiceNumber}`,text:`${s==null?void 0:s.customer.name} - ${r((s==null?void 0:s.grandTotal)||0)}`,url:window.location.href}):(await navigator.clipboard.writeText(window.location.href),n.success("Link kopyalandƒ±"))}catch(t){console.error("Share failed:",t)}},r=t=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),i=t=>new Date(t).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"}),z=t=>{const l={draft:{label:"Taslak",color:"bg-neutral-100 text-gray-800",icon:h},sent:{label:"G√∂nderildi",color:"bg-blue-100 text-blue-800",icon:j},paid:{label:"√ñdendi",color:"bg-green-100 text-green-800",icon:R},overdue:{label:"Vadesi Ge√ßti",color:"bg-red-100 text-red-800",icon:K},cancelled:{label:"ƒ∞ptal",color:"bg-neutral-100 text-gray-800",icon:M}},a=l[t]||l.draft,D=a.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium ${a.color}`,children:[e.jsx(D,{size:14}),a.label]})};if(g)return e.jsx(C,{});if(!s)return e.jsx("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(h,{size:48,className:"text-neutral-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-neutral-900 mb-2",children:"Fatura bulunamadƒ±"}),e.jsx("p",{className:"text-neutral-600 mb-4",children:"Bu fatura silinmi≈ü veya mevcut deƒüil."}),e.jsxs(A,{to:"/accounting?tab=invoice",className:"inline-flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-xl hover:bg-neutral-800 transition-colors",children:[e.jsx(p,{size:18}),"Fatura Listesine D√∂n"]})]})});const m=s.grandTotal>0?Math.round(s.paidAmount/s.grandTotal*100):0;return e.jsxs("div",{className:"min-h-screen bg-neutral-50",children:[e.jsx("div",{className:"bg-white border-b border-neutral-200 print:hidden",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>c("/accounting?tab=invoice"),className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",children:e.jsx(p,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:s.invoiceNumber}),e.jsx("p",{className:"text-sm text-neutral-600",children:s.customer.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:k,className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",title:"Payla≈ü",children:e.jsx(P,{size:20})}),e.jsx("button",{onClick:y,className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",title:"PDF ƒ∞ndir",children:e.jsx(S,{size:20})}),e.jsx("button",{onClick:v,className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",title:"Yazdƒ±r",children:e.jsx(B,{size:20})}),e.jsx("button",{onClick:w,className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",title:"E-posta G√∂nder",children:e.jsx(j,{size:20})}),e.jsxs("button",{onClick:()=>c(`/accounting/invoice/${s.id}/edit`),className:"px-4 py-2 bg-neutral-900 text-white rounded-xl hover:bg-neutral-800 transition-colors flex items-center gap-2",children:[e.jsx(E,{size:18}),"D√ºzenle"]}),e.jsx("button",{onClick:f,className:"p-2 hover:bg-red-100 text-red-600 rounded-lg transition-colors",title:"Sil",children:e.jsx(I,{size:20})})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-neutral-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-neutral-900",children:"Fatura Bilgileri"}),z(s.status)]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-neutral-600 mb-1",children:[e.jsx($,{size:16}),"Fatura Tarihi"]}),e.jsx("p",{className:"font-medium text-neutral-900",children:i(s.invoiceDate)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-neutral-600 mb-1",children:[e.jsx(L,{size:16}),"Vade Tarihi"]}),e.jsx("p",{className:"font-medium text-neutral-900",children:i(s.dueDate)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-neutral-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(G,{size:20}),"M√º≈üteri Bilgileri"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Ad/√únvan"}),e.jsx("p",{className:"font-medium text-neutral-900",children:s.customer.name})]}),s.customer.email&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"E-posta"}),e.jsx("p",{className:"font-medium text-neutral-900",children:s.customer.email})]}),s.customer.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Telefon"}),e.jsx("p",{className:"font-medium text-neutral-900",children:s.customer.phone})]}),s.customer.taxNumber&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Vergi No"}),e.jsx("p",{className:"font-medium text-neutral-900",children:s.customer.taxNumber})]}),s.customer.address&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600",children:"Adres"}),e.jsx("p",{className:"font-medium text-neutral-900",children:s.customer.address})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-neutral-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-neutral-200",children:e.jsx("h2",{className:"text-lg font-semibold text-neutral-900",children:"Kalemler"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-700 uppercase",children:"A√ßƒ±klama"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"Miktar"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"Birim Fiyat"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-700 uppercase",children:"Toplam"})]})}),e.jsx("tbody",{className:"divide-y divide-neutral-200",children:s.items.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-neutral-900",children:t.description}),t.equipment&&e.jsxs("p",{className:"text-sm text-neutral-600",children:[t.equipment.name,t.equipment.serialNumber&&` (${t.equipment.serialNumber})`]})]})}),e.jsx("td",{className:"px-6 py-4 text-right text-neutral-900",children:t.quantity}),e.jsx("td",{className:"px-6 py-4 text-right text-neutral-900",children:r(t.unitPrice)}),e.jsx("td",{className:"px-6 py-4 text-right font-medium text-neutral-900",children:r(t.total)})]},t.id))})]})}),e.jsx("div",{className:"p-6 bg-neutral-50 border-t border-neutral-200",children:e.jsxs("div",{className:"max-w-sm ml-auto space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-neutral-700",children:[e.jsx("span",{children:"Ara Toplam"}),e.jsx("span",{className:"font-medium",children:r(s.subtotal)})]}),s.discountAmount&&s.discountAmount>0&&e.jsxs("div",{className:"flex justify-between text-neutral-700",children:[e.jsx("span",{children:"ƒ∞ndirim"}),e.jsxs("span",{className:"font-medium text-red-600",children:["-",r(s.discountAmount)]})]}),e.jsxs("div",{className:"flex justify-between text-neutral-700",children:[e.jsx("span",{children:"KDV"}),e.jsx("span",{className:"font-medium",children:r(s.taxAmount)})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold text-neutral-900 pt-2 border-t border-neutral-300",children:[e.jsx("span",{children:"Genel Toplam"}),e.jsx("span",{children:r(s.grandTotal)})]})]})})]}),s.notes&&e.jsxs("div",{className:"bg-white rounded-2xl border border-neutral-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-neutral-900 mb-3",children:"Notlar"}),e.jsx("p",{className:"text-neutral-700 whitespace-pre-wrap",children:s.notes})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-neutral-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx(q,{size:20}),"√ñdeme Durumu"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm text-neutral-600 mb-2",children:[e.jsx("span",{children:"√ñdenen"}),e.jsxs("span",{children:[m,"%"]})]}),e.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all",style:{width:`${m}%`}})})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t border-neutral-200",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-700",children:"Toplam Tutar"}),e.jsx("span",{className:"font-semibold text-neutral-900",children:r(s.grandTotal)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-700",children:"√ñdenen"}),e.jsx("span",{className:"font-semibold text-green-600",children:r(s.paidAmount)})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-neutral-200",children:[e.jsx("span",{className:"text-neutral-900 font-medium",children:"Kalan"}),e.jsx("span",{className:"font-bold text-neutral-900",children:r(s.remainingAmount)})]})]}),s.remainingAmount>0&&e.jsx("button",{className:"w-full mt-4 px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors",children:"√ñdeme Kaydet"})]})]}),s.paymentHistory&&s.paymentHistory.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-neutral-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"√ñdeme Ge√ßmi≈üi"}),e.jsx("div",{className:"space-y-3",children:s.paymentHistory.map(t=>e.jsxs("div",{className:"pb-3 border-b border-neutral-200 last:border-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-medium text-neutral-900",children:r(t.amount)}),e.jsx("span",{className:"text-xs text-neutral-600",children:i(t.paymentDate)})]}),e.jsx("p",{className:"text-sm text-neutral-600",children:t.paymentMethod}),t.notes&&e.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:t.notes})]},t.id))})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-neutral-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"ƒ∞≈ülem Ge√ßmi≈üi"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-900",children:"Fatura olu≈üturuldu"}),e.jsx("p",{className:"text-xs text-neutral-600",children:i(s.createdAt)}),s.createdBy&&e.jsx("p",{className:"text-xs text-neutral-500",children:s.createdBy.name})]})]}),s.updatedAt!==s.createdAt&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-600 rounded-full mt-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-900",children:"Fatura g√ºncellendi"}),e.jsx("p",{className:"text-xs text-neutral-600",children:i(s.updatedAt)})]})]})]})]})]})]})})]})}export{O as default};
